

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Welcome to segmenter_model_zoo’s documentation! &mdash; segmenter_model_zoo 0.0.5 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home" alt="Documentation Home"> segmenter_model_zoo
          

          
          </a>

          
            
            
              <div class="version">
                0.0.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#stable-release">Stable release</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#from-sources">From sources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Package modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="segmenter_model_zoo.html">segmenter_model_zoo package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="segmenter_model_zoo.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="segmenter_model_zoo.bin.html">segmenter_model_zoo.bin package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="segmenter_model_zoo.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="segmenter_model_zoo.html#module-segmenter_model_zoo.quilt_utils">segmenter_model_zoo.quilt_utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="segmenter_model_zoo.html#module-segmenter_model_zoo.utils">segmenter_model_zoo.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="segmenter_model_zoo.html#module-segmenter_model_zoo.zoo">segmenter_model_zoo.zoo module</a></li>
<li class="toctree-l3"><a class="reference internal" href="segmenter_model_zoo.html#module-segmenter_model_zoo">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#get-started">Get Started!</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#deploying">Deploying</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="math.html">Math notation example</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">segmenter_model_zoo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>Welcome to segmenter_model_zoo’s documentation!</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="installation.html" class="btn btn-neutral float-right" title="Installation" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="welcome-to-segmenter-model-zoo-s-documentation">
<h1>Welcome to segmenter_model_zoo’s documentation!<a class="headerlink" href="#welcome-to-segmenter-model-zoo-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="segmenter-model-zoo">
<h1>segmenter_model_zoo<a class="headerlink" href="#segmenter-model-zoo" title="Permalink to this headline">¶</a></h1>
<a class="reference external image-reference" href="https://github.com/AllenCell/segmenter_model_zoo/actions"><img alt="Build Status" src="https://github.com/AllenCell/segmenter_model_zoo/workflows/Build%20Master/badge.svg" /></a>
<a class="reference external image-reference" href="https://AllenCell.github.io/segmenter_model_zoo"><img alt="Documentation" src="https://github.com/AllenCell/segmenter_model_zoo/workflows/Documentation/badge.svg" /></a>
<a class="reference external image-reference" href="https://codecov.io/gh/AllenCell/segmenter_model_zoo"><img alt="Code Coverage" src="https://codecov.io/gh/AllenCell/segmenter_model_zoo/branch/main/graph/badge.svg" /></a>
<p>Batch processing script and functions for running deep learning based segmentation models released by Allen Institute for Cell Science.</p>
<hr class="docutils" />
<div class="section" id="features">
<h2>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Reproducing deep learning based segmentation results in Allen Cell Data Collection</p></li>
<li><p>Pulling models from Allen Cell quilt buckets automatically</p></li>
<li><p>Supporting both command line batch processing and python API callable in other functions</p></li>
<li><p>Serving as a starting point for iterative deep learning on your own data</p></li>
<li><p>Adding more models continously when ready</p></li>
</ul>
</div>
<div class="section" id="system-requirement">
<h2>System requirement<a class="headerlink" href="#system-requirement" title="Permalink to this headline">¶</a></h2>
<p>Most of the models can run at any Linux or Windows machine with NVIDIA GPU properly
setup up. The only exception is the full version of cells and nuclei segmentation used
in Allen Cell Data Collection, which uses an object detection model that requires
compiling certain CUDA code in Linux. So the full version is only supported in Linux, but
we provide a simplified version without object detection that can run on both Windows and Linux, which will also be useful for most users. See more details in the list of models below.</p>
<p>Note: If you are using Windows and see the an error like <code class="docutils literal notranslate"><span class="pre">error:</span> <span class="pre">Microsoft</span> <span class="pre">Visual</span> <span class="pre">C++</span> <span class="pre">14.0</span> <span class="pre">or</span> <span class="pre">greater</span> <span class="pre">is</span> <span class="pre">required.</span> <span class="pre">Get</span> <span class="pre">it</span> <span class="pre">with</span> <span class="pre">Microsoft</span> <span class="pre">C++</span> <span class="pre">Build</span> <span class="pre">Tools</span></code>, then juse follow the detailed intruction in the error message to download Microsoft Build Tools. The specific version we used is <em>MSVC v142 - VS 2019 C++ x64/x86 build tools (v14.27)</em></p>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="step-1-install-pytorch-from-official-website">
<h3>Step 1: Install PyTorch from official website<a class="headerlink" href="#step-1-install-pytorch-from-official-website" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference external" href="https://pytorch.org/get-started/locally/">official instruction</a>. We have tested on 1.3.1, 1.4.0, 1.6.0, 1.7.0 on CUDA 10.1 and CUDA 10.2</p>
</div>
<div class="section" id="step-2-install-segmenter-model-zoo">
<h3>Step 2: Install segmenter_model_zoo<a class="headerlink" href="#step-2-install-segmenter-model-zoo" title="Permalink to this headline">¶</a></h3>
<p><strong>Install stable release and use as it:</strong>
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">segmenter_model_zoo</span></code><span class="raw-html-m2r"><br></span></p>
<p><strong>Install nightly development head and make customization:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone git@github.com:AllenCell/segmenter_model_zoo.git
<span class="nb">cd</span> segmenter_model_zoo
pip install -e .<span class="o">[</span>all<span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="step-3-optional-install-pytorch-fnet-and-cell-detector-if-you-want-to-use-the-full-version-of-cells-and-nuclei-segmentation-for-linux-only">
<h3>Step 3 (Optional): Install pytorch-fnet and cell-detector if you want to use the full version of cells and nuclei segmentation (for Linux only)<a class="headerlink" href="#step-3-optional-install-pytorch-fnet-and-cell-detector-if-you-want-to-use-the-full-version-of-cells-and-nuclei-segmentation-for-linux-only" title="Permalink to this headline">¶</a></h3>
<p><strong>Install pytorch-fnet for running label-free model</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/AllenCellModeling/pytorch_fnet.git
<span class="nb">cd</span> pytorch_fnet
git checkout ad_customization
pip install .
</pre></div>
</div>
<p><strong>Install cell-detector</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone ssh://git@aicsbitbucket.corp.alleninstitute.org:7999/assay/cell_detector.git
<span class="nb">cd</span> cell_detector
pip install .
<span class="nb">cd</span> ./cell_detector/bin/apex
python setup.py install --cuda_ext --cpp_ext
<span class="nb">cd</span> ..  <span class="c1"># assume you are under /cell_detector/cell_detector/bin</span>
rm -rf build
python setup.py build develop
</pre></div>
</div>
<p>Note: Depending on your CUDA version and different generations of your GPU, you may need different pytorch version to make cell-detector working properly. We found <code class="docutils literal notranslate"><span class="pre">pytorch==1.3.1</span></code> and <code class="docutils literal notranslate"><span class="pre">torchvision==0.4.2</span></code> is a stable version for both CUDA 10.1 and CUDA 10.2 and working well for NVDIA titanx, titanxp, gtx1080, v100 GPUs. So, if you find installation failed on your current environment, you may switch to <code class="docutils literal notranslate"><span class="pre">pytorch==1.3.1</span></code> and <code class="docutils literal notranslate"><span class="pre">torchvision==0.4.2</span></code>.</p>
</div>
</div>
<div class="section" id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h2>
<p>In general there two types of models: basic models and super models. Basic model is just a trained neural network. Super model can be multiple basic models + certain preprocesisng and post processing steps to generate the final output.</p>
<p>Current basic models:</p>
<ul>
<li><p>[v] DNA_mask_production: from nuclei images (via DNA dye) to the semantic segmentation mask of DNA</p></li>
<li><p>[v] DNA_seed_production: from nuclei images (via DNA dye) to genearate one seed per DNA</p></li>
<li><p>[v] CellMask_edge_production: from cell membrane images (via CellMask dye) to semantic cell membrane segmentation</p></li>
<li><p>[v] CAAX_production: from CAAX images to semantic CAAX segmentation</p></li>
<li><p>[v] LMNB1_all_production: from lamin B1 images to the semanic lamin b1 segmentation</p></li>
<li><p>[v] LMNB1_fill_production: from lamin B1 images to the mask of nuclei (filled shapes) except mitotic cells</p></li>
<li><p>[v] LMNB1_seed_production: from lamin B1 images to generate one seed per nucleus</p></li>
<li><p>[v] H2B_coarse: from H2B images to coarse H2B segmentation. NOTE: this is not the H2B segmentation provided in the
.. code-block:: guess</p>
<blockquote>
<div><p>Allen Cell Data Collection. This is a coarse version, which can be roughly considered as equivelant to nuclear
segmentation</p>
</div></blockquote>
</li>
</ul>
<p>Current super models:</p>
<ul>
<li><p>[v] DNA_MEM_instance_plus_LF: full version of cells and nuclei segmentaiton for images in Allen Cell Data Collection that
.. code-block:: guess</p>
<blockquote>
<div><p>were acquired with old single camera pipeline</p>
</div></blockquote>
</li>
<li><p>[v] DNA_MEM_instance_plus_LF_two_camera: full version of cells and nuclei segmentaiton for images in Allen Cell Data Collection that
.. code-block:: guess</p>
<blockquote>
<div><p>were acquired with current two-camera pipeline</p>
</div></blockquote>
</li>
<li><p>[v] DNA_MEM_instance_basic: simplified version of cells and nuclei segmentaiton applicable for all images in Allen Cell Data
.. code-block:: guess</p>
<blockquote>
<div><p>Collection. Comparing to the full version, labelfree and cell pair correction were excluded for simplicity.</p>
</div></blockquote>
</li>
<li><p>[v] LMNB1_morphological_production_alpha: lamin B1 morphological segmentation for the lamib B1 cell line in Allen Cell Data
.. code-block:: guess</p>
<blockquote>
<div><p>Collection. Comparing to basic semantic lamib B1 segmentation, the morphological segmentation refers that the lamin shells are fully closed
(i.e. topologically fillable in 3D)</p>
</div></blockquote>
</li>
<li><p>[v] structure_AAVS1_100x_hipsc: from CAAX images for final binary results of semantic CAAX segmentation</p></li>
<li><p>[v] structure_H2B_100x_hipsc: from H2B images for final binary results of coarse H2B segmentation</p></li>
</ul>
<p>There are a few auxillary models available as part of the full version of cells and nuclei segmentation</p>
<ul class="simple">
<li><p>[v] LF_DNA_mask: label-free model predicting DNA segmentation mask from bright field</p></li>
<li><p>[v] LF_DNA_mask_two_camera: label-free model predicting DNA segmentation mask from bright field, but only for images acquired uisng two-camera pipeline (slightly different bright field images)</p></li>
<li><p>[v] LF_mem_edge: label-free model predicting cell membrane segmentation from bright field</p></li>
<li><p>[v] LF_mem_edge_two_camera: label-free model predicting cell membrane segmentation from bright field, but only for images acquired uisng two-camera pipeline (slightly different bright field images)</p></li>
<li><p>[v] cell_pair_det_prod: a 2D object detection model to identify the pair of daughter cells during late mitosis</p></li>
</ul>
<p><em>NOTE: the terms used here, e.g. nuclei images, cell membrane images, two-camera pipeline and single camera pipeline, etc., omit more bioloigical and imaging details which could be important to the success of applying our models on images not from Allen Cell Data Collection. Please refer Allen Cell Data Collection for details (e.g., the imaging modality or the z step size could be important).</em></p>
<p>To use these models:</p>
<ol class="arabic simple">
<li><p>You can prepare a yaml configuration file (see examples <a class="reference external" href="https://github.com/AllenCell/segmenter_model_zoo/tree/main/config_examples">HERE</a>, just specify which super model to use and input/output path) and then run</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>run_model_zoo --config /path/to/your/config.yaml --debug
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>You can run basic models or super models using provided python API. See the demo jupyter notebooks <a class="reference external" href="https://github.com/AllenCell/segmenter_model_zoo/tree/main/playbooks">HERE</a>.</p></li>
</ol>
<p>For full package documentation please visit <a class="reference external" href="https://AllenCell.github.io/segmenter_model_zoo">AllenCell.github.io/segmenter_model_zoo</a>.</p>
</div>
<div class="section" id="development">
<h2>Development<a class="headerlink" href="#development" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference external" href="CONTRIBUTING.md">CONTRIBUTING.md</a> for information related to developing the code.</p>
</div>
<div class="section" id="questions">
<h2>Questions?<a class="headerlink" href="#questions" title="Permalink to this headline">¶</a></h2>
<p>If you have any questions, feel free to leave a comment in our Allen Cell forum: <a class="reference external" href="https://forum.allencell.org/">https://forum.allencell.org/</a>.</p>
<p><a href="#id2"><span class="problematic" id="id3">**</span></a><em>Free software: Allen Institute Software License</em>**</p>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Jianxu Chen

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>